"use strict";(self.webpackChunkgefyra=self.webpackChunkgefyra||[]).push([[4747],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=o.createContext({}),s=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=s(e.components);return o.createElement(l.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=s(t),d=a,f=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return t?o.createElement(f,r(r({ref:n},p),{},{components:t})):o.createElement(f,r({ref:n},p))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,r=new Array(i);r[0]=d;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c[u]="string"==typeof e?e:a,r[1]=c;for(var s=2;s<i;s++)r[s]=t[s];return o.createElement.apply(null,r)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1723:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>s});var o=t(7462),a=(t(7294),t(3905));const i={title:"Connecting to Gefyra",sidebar_position:3},r="Connecting to Gefyra",c={unversionedId:"shared-environments/connecting",id:"version-2.0.0/shared-environments/connecting",title:"Connecting to Gefyra",description:"If you have a Gefyra client file and want to connect to a shared Kubernetes cluster,",source:"@site/versioned_docs/version-2.0.0/shared-environments/connecting.md",sourceDirName:"shared-environments",slug:"/shared-environments/connecting",permalink:"/docs/shared-environments/connecting",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/versioned_docs/version-2.0.0/shared-environments/connecting.md",tags:[],version:"2.0.0",sidebarPosition:3,frontMatter:{title:"Connecting to Gefyra",sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Managing Gefyra Clients",permalink:"/docs/shared-environments/clients"},next:{title:"Setting Up Shared Kubernetes Clusters",permalink:"/docs/shared-environments/remote-k8s/"}},l={},s=[{value:"Managing Connections",id:"managing-connections",level:2},{value:"Connect",id:"connect",level:3},{value:"Listing Connections",id:"listing-connections",level:3},{value:"Disconnect",id:"disconnect",level:3},{value:"Connection Names",id:"connection-names",level:3},{value:"Simultaneous Connections",id:"simultaneous-connections",level:2}],p={toc:s},u="wrapper";function m(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"connecting-to-gefyra"},"Connecting to Gefyra"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("mdxAdmonitionTitle",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"mdxAdmonitionTitle"},"TLDR;")),(0,a.kt)("p",{parentName:"admonition"},"If you have a Gefyra ",(0,a.kt)("em",{parentName:"p"},"client file")," and want to connect to a shared Kubernetes cluster,",(0,a.kt)("br",{parentName:"p"}),"\n","just run ",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra connections connect -f <file>"),".")),(0,a.kt)("p",null,"Connecting to a Gefyra-enabled Kubernetes cluster is the process of any Gefyra client to establish a networking connection based on ",(0,a.kt)("a",{parentName:"p",href:"https://www.wireguard.com/"},"Wireguard VPN")," to a cluster. It is a multistep process that involves the dynamic creation of connection credentials and IP-range negotiation\nbetween cluster and client. The network connection is persistent for the session, rock-solid and blazingly fast."),(0,a.kt)("admonition",{title:"Prerequisites",type:"note"},(0,a.kt)("ol",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ol"},"Gefyra is ",(0,a.kt)("a",{parentName:"li",href:"https://gefyra.dev/installation"},"available")," (at least in version 2.0.0)"),(0,a.kt)("li",{parentName:"ol"},"A running Docker host on the machine that connects  "),(0,a.kt)("li",{parentName:"ol"},"A Gefyra ",(0,a.kt)("a",{parentName:"li",href:"/docs/shared-environments/clients#a-default-client-file"},(0,a.kt)("em",{parentName:"a"},"client file"))))),(0,a.kt)("h2",{id:"managing-connections"},"Managing Connections"),(0,a.kt)("p",null,"Client connections to a Gefyra cluster are managed with the ",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra connections")," command group.",(0,a.kt)("br",{parentName:"p"}),"\n","The connection itself consists of a file, that is located in a local user directory, and ",(0,a.kt)("em",{parentName:"p"},"usually")," a\nDocker container that acts as a VPN endpoint on a local machine."),(0,a.kt)("h3",{id:"connect"},"Connect"),(0,a.kt)("admonition",{title:"Gefyra client file required",type:"important"},(0,a.kt)("p",{parentName:"admonition"},"You can only connect to a Gefyra cluster with a ",(0,a.kt)("a",{parentName:"p",href:"/docs/shared-environments/clients#distributing-the-client-file"},(0,a.kt)("em",{parentName:"a"},"client file")),".\nIf you don't have such a client file, either ",(0,a.kt)("a",{parentName:"p",href:"/docs/shared-environments/installation"},"set up Gefyra in a Kubernetes cluster")," and create yourself\n",(0,a.kt)("a",{parentName:"p",href:"/docs/shared-environments/clients#creating-a-gefyra-client"},"a Gefyra ",(0,a.kt)("em",{parentName:"a"},"client")),", or find the responsible person and ask for access.")),(0,a.kt)("p",null,"Establishing a connection (",(0,a.kt)("strong",{parentName:"p"},"for the first time"),") to Gefyra works like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"> gefyra connections connect -f myfancyclient.json\n\nCreating the cluster connection 'default' |   \u25b6\u25b6\u25b6\u25b6\u25b6\u25b6\u25b6          | / 0 in 28s\n\nConnection established with connection name 'default'. Run 'gefyra connections list' to see all connections.\n")),(0,a.kt)("p",null,"This example assumes, there is a client that provides the client file ",(0,a.kt)("em",{parentName:"p"},"myfancyclient.json"),". A couple of things happened during this process:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Gefyra fetched the ad-hoc VPN credentials for this connection"),(0,a.kt)("li",{parentName:"ol"},"A container for the Gefyra connection with name ",(0,a.kt)("em",{parentName:"li"},"default")," has been started"),(0,a.kt)("li",{parentName:"ol"},"A dedicated Docker network has been created"),(0,a.kt)("li",{parentName:"ol"},"The connection was successfully checked")),(0,a.kt)("p",null,"If you check your Docker host, you will find a container named ",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra-cargo-default")," running. That's the gateway into the cluster."),(0,a.kt)("admonition",{title:"Default connection",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Since we didn't specify a ",(0,a.kt)("em",{parentName:"p"},"connection name")," and there was no ",(0,a.kt)("em",{parentName:"p"},"default")," connection available before, creating it was successful. However, there\nis only one ",(0,a.kt)("em",{parentName:"p"},"default")," connection on a client machine. Additional connections must ",(0,a.kt)("a",{parentName:"p",href:"#connection-names"},"be assigned a name"),".")),(0,a.kt)("p",null,"Once you have a stopped connection, you don't need the client file anymore to connect. Just run the following with the ",(0,a.kt)("em",{parentName:"p"},"default")," connection:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"> gefyra connections connect\n")),(0,a.kt)("p",null,"The Gefyra connection will be back up in no time. Of course, if you do have multiple connections, you have to specify the connection name with the\n",(0,a.kt)("inlineCode",{parentName:"p"},"--connection-name")," option."),(0,a.kt)("admonition",{title:"Client file superseded",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"After you successfully connected a machine with a Gefyra cluster, the ",(0,a.kt)("em",{parentName:"p"},"client file")," is typically superseded at that point. Gefyra stores the\ncredentials from the file elsewhere, so a user doesn't have to handle the file. However, if you remove your connection and want to reconnect\nto the cluster (assuming the Gefyra client is still the same) you may connect to the cluster with that file again. Yet, you can also request a\nnew one, which is safer than having a ",(0,a.kt)("em",{parentName:"p"},"client file")," dangling.")),(0,a.kt)("h3",{id:"listing-connections"},"Listing Connections"),(0,a.kt)("p",null,"To see all Gefyra connections on a local machine, please run the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"> gefyra connections list\nNAME     VERSION    CREATED                         STATUS\ndefault  2.0.0      2023-10-10T18:36:15.519969679Z  running\n")),(0,a.kt)("p",null,"You will find the status of all of your connections here. It can be ",(0,a.kt)("inlineCode",{parentName:"p"},"running"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"stopped")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"error"),"."),(0,a.kt)("h3",{id:"disconnect"},"Disconnect"),(0,a.kt)("p",null,"To actively disconnect from the cluster, you run this command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"gefyra connections stop\n")),(0,a.kt)("p",null,"This assumes you have a ",(0,a.kt)("em",{parentName:"p"},"default")," connection currently running. If not, you have to provide a valid connection name with the ",(0,a.kt)("inlineCode",{parentName:"p"},"--connection-name")," option."),(0,a.kt)("p",null,"You will find this connection to be stopped from the client's side. However, if you want to reconnect to the cluster, you can now run ",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra connections connect")," again. The connection process will be superfast this time."),(0,a.kt)("admonition",{title:"Deleting a connection",type:"important"},(0,a.kt)("p",{parentName:"admonition"},"If you want to delete a connection, and thus release the Gefyra client in the cluster, you can run ",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra connections remove"),". If you want to reconnect\nlater, you will need a ",(0,a.kt)("em",{parentName:"p"},"client file")," again.")),(0,a.kt)("h3",{id:"connection-names"},"Connection Names"),(0,a.kt)("p",null,"You can assign (and have to) names to your connections if you have more than one. Almost all commands of the Gefyra CLI support\nthe ",(0,a.kt)("inlineCode",{parentName:"p"},"--connection-name")," option to specify the connection a certain command is targeting. Most importantly, for\n",(0,a.kt)("inlineCode",{parentName:"p"},"gefyra run --connection-name")," you specify to which cluster a local container is connected."),(0,a.kt)("p",null,"To create a new connection with a name (in this example ",(0,a.kt)("inlineCode",{parentName:"p"},"my-conn1"),"), please run the following to set up a connection with a given name:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"gefyra connections connect --connection-name my-conn1 ... \n")),(0,a.kt)("p",null,"The connection will show up in the connection list:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"> gefyra connections list\nNAME     VERSION    CREATED                         STATUS\ndefault  2.0.0      2023-10-10T18:36:15.519969679Z  running\nmy-conn1 2.0.1      2023-10-12T12:14:11.48715/726Z  running\n")),(0,a.kt)("p",null,"You can manage connections based on the local names, i.e. halt the connection, reconnect, remove it, and run containers with it."),(0,a.kt)("h2",{id:"simultaneous-connections"},"Simultaneous Connections"),(0,a.kt)("p",null,"As you can see above, it is possible to create a list of connections simultaneously. They can be individually managed, like started and stopped, even at the same time.",(0,a.kt)("br",{parentName:"p"}),"\n","It is possible to have multiple connections to one cluster, too."))}m.isMDXComponent=!0}}]);