"use strict";(self.webpackChunkgefyra=self.webpackChunkgefyra||[]).push([[228],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),g=r,m=u["".concat(p,".").concat(g)]||u[g]||d[g]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=g;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},1541:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const o={layout:"page",title:"Developing Go Applications with Gefyra",permalink:"/usecases/developing-go-with-gefyra/",nav_order:5,parent:"Use Cases and Demos"},i="Developing Go Applications with Gefyra",l={unversionedId:"usecases/golang",id:"usecases/golang",title:"Developing Go Applications with Gefyra",description:"Simple Usecase",source:"@site/docs/usecases/golang.md",sourceDirName:"usecases",slug:"/usecases/golang",permalink:"/docs/usecases/golang",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usecases/golang.md",tags:[],version:"current",frontMatter:{layout:"page",title:"Developing Go Applications with Gefyra",permalink:"/usecases/developing-go-with-gefyra/",nav_order:5,parent:"Use Cases and Demos"},sidebar:"docsSidebar",previous:{title:"Remote Development on Google Kubernetes Engine",permalink:"/docs/usecases/remote-gke"},next:{title:"Enterprise Support",permalink:"/docs/enterprise"}},p={},s=[{value:"What you will learn",id:"what-you-will-learn",level:3},{value:"What you will need",id:"what-you-will-need",level:3},{value:"Creating the Development Infrastructure",id:"creating-the-development-infrastructure",level:3},{value:"The Demo Application",id:"the-demo-application",level:3},{value:"Enter Gefyra",id:"enter-gefyra",level:3}],c={toc:s},u="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"developing-go-applications-with-gefyra"},"Developing Go Applications with Gefyra"),(0,r.kt)("p",null,"Simple Usecase"),(0,r.kt)("p",null,"This example demonstrates how to run a local Golang container with hot code reloading as part of your Kubernetes namespace. "),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"what-you-will-learn"},"What you will learn"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Running a Go application in a local container with hot code reloading"),(0,r.kt)("li",{parentName:"ul"},"Using Gefyra to bridge the container into a Kubernetes cluster")),(0,r.kt)("h3",{id:"what-you-will-need"},"What you will need"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/installation"},"Gefyra")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/Getdeck/getdeck"},"Getdeck")," for setting up the development infrastructure (runs on ",(0,r.kt)("inlineCode",{parentName:"li"},"k3d"),")"),(0,r.kt)("li",{parentName:"ul"},"A copy of ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/gefyrahq/gefyra-demos"},"https://github.com/gefyrahq/gefyra-demos")),(0,r.kt)("li",{parentName:"ul"},"Optionally: ",(0,r.kt)("a",{parentName:"li",href:"https://k3d.io"},"k3d")," or any other preferred Kubernetes cluster")),(0,r.kt)("h3",{id:"creating-the-development-infrastructure"},"Creating the Development Infrastructure"),(0,r.kt)("p",null,"After cloning the gefyra-demos repository, you can start a local k3d based Kubernetes cluster with the Go demo workload by running"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"cd golang-demo\ndeck get deck.yaml\n")),(0,r.kt)("p",null,"Once everything is up and running, you can visit ",(0,r.kt)("a",{parentName:"p",href:"http://gefyra-golang.127.0.0.1.nip.io:8080"},"http://gefyra-golang.127.0.0.1.nip.io:8080")," to verify that everything worked as expected."),(0,r.kt)("h3",{id:"the-demo-application"},"The Demo Application"),(0,r.kt)("p",null,"You can look at and tweak the code for the demo application in ",(0,r.kt)("inlineCode",{parentName:"p"},"app/main.go"),". You will find a very simple HTTP API that returns a String when it receives GET requests at the base route.\nIn the ",(0,r.kt)("inlineCode",{parentName:"p"},"app"),"-directory, you'll also find the Dockerfile that is used to build the container image containing our application.\n",(0,r.kt)("strong",{parentName:"p"},"Note"),": In the Dockerfile, we install ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cosmtrek/air"},"air"),", a hot reloading utillity for Go development. In a production Dockerfile, you'd want to specify a dedicated\nbuild target to install air."),(0,r.kt)("h3",{id:"enter-gefyra"},"Enter Gefyra"),(0,r.kt)("p",null,"In order to connect a locally running container to a Kubernetes cluster, we use Gefyra.\nFirst of all, we need to build an image on our development machine like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"cd app\ndocker build . -t gefyra-golang-example\n")),(0,r.kt)("p",null,"Once the build is finished, we are ready to get started with Gefyra:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"gefyra up\ngefyra run -i gefyra-golang-example -N gefyra-golang-example -n golang-demo -c air -v $(pwd):/app\ngefyra bridge -N gefyra-golang-example --container-name gefyra-golang-demo --deployment gefyra-golang-demo --port 3333:3333 -n golang-example\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"gefyra up")," will start the cluster and client side components needed for Gefyra to do it's thing.\nThe ",(0,r.kt)("inlineCode",{parentName:"p"},"gefyra run")," command will then start a container from the image that we just build in the development infrastructure that we created before.\nFinally, 'gefyra bridge' will overlay our local container over the one that we specified in the run command."),(0,r.kt)("p",null,"Once Gefyra tells you that the bridge is established, you're ready to make some changes and check out hot code reloading in Kubernetes in action.\nVisit ",(0,r.kt)("a",{parentName:"p",href:"http://gefyra-golang.127.0.0.1.nip.io:8080"},"http://gefyra-golang.127.0.0.1.nip.io:8080")," in your browser and try changing the contents of the\n",(0,r.kt)("inlineCode",{parentName:"p"},"io.WriteString")," function. Since we mounted our code into the container during ",(0,r.kt)("inlineCode",{parentName:"p"},"gefyra run"),", air will detect the changes and rebuild/restart our application.\nRefresh your browser and check out the results!"))}d.isMDXComponent=!0}}]);